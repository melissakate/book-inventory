.navbar.navbar-inverse
  .navbar-inner
    %a.brand Book Inventory
    .container
      %a{:class => "btn btn-navbar", "data-toggle" => 'collapse', "data-target" => ".nav-collapse"}
        %ul.nav
          - if params[:action] == "index"
            %li.active
              = link_to "Products" , products_path, html: {class: "btn"}          
          - else
            %li 
              = link_to "Products" , products_path, html: {class: "btn"}
          - if params[:action] == "new"
            %li.active
              = link_to "Add Product" ,new_product_path
          - else
            %li
              = link_to "Add Product" ,new_product_path 
          - if params[:action] == "funborrowed"
            %li.active
              = link_to "Unborrowed Books" , unborrowed_products_path , method: "get"
          - else
            %li
              = link_to "Unborrowed Books" , unborrowed_products_path , method: "get"
          - if params[:action] == "fborrowed"
            %li.active
              = link_to "Borrowed Books" ,borrowed_products_path , method: "get"
          - else
            %li
              = link_to "Borrowed Books" , borrowed_products_path , method: "get"

%header{:id => "overview" , :class => "jumbotron subhead"}
  .container
    %h1
      List of Products
%br
.well.well-small
  %table.table.table-striped
    %tr
      %th Title
      %th Description
      %th Author
      %th Publisher
      %th Price
      - if params[:action] == "index"
        %th Purchased On
        %th Purchased At
      - elsif params[:action] == "borrowed"
        %th Borrowed By
      %th Action
    - @products.each do |product|
      %tr 
        %td 
          = product.title
        %td
          = product.description
        %td
          = product.author
        %td
          = product.publisher
        %td
          = product.price
        - if params[:action] == "index"
          %td
            = product.purchased_on
          %td
            = product.purchased_at
        %td
          - if params[:action] == "unborrowed"
            = link_to "Borrow", new_product_borrow_history_path(product.id) , class: "btn"
          - elsif params[:action] == "borrowed"
            = product.borrow_histories.last.borrowed_by
            %td
              = link_to "Return", product_borrow_history_path(product.id, product.borrow_histories.last) , method: :put , class: "btn"
          - else
            .btn-group
              %a{:class => "btn btn-primary dropdown-toggle" ,"data-toggle" => "dropdown" }
                Action
                %span.caret
              %ul.dropdown-menu
                %li
                  = link_to 'Show', product
                %li
                  = link_to 'Edit', edit_product_path(product.id), method: "get"
                %li
                  = link_to 'Delete', product, method: :delete, data: {confirm: 'Are you sure?' }
                %li.divider
                %li
                  = link_to "Borrow History" , product_borrow_histories_path(product.id)

